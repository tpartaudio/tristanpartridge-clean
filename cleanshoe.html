<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <!-- ============================================= -->
  <!-- 1. META & TITLE                              -->
  <!-- ============================================= -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tie - Tristan Partridge</title>

  <!-- ============================================= -->
  <!-- 2. CONFIGURATION (CHANGE HERE FOR EACH PROJECT) -->
  <!-- ============================================= -->
  <style>
    :root {
      /* Video */
      --video-src: https://wocyyrc2hiwuxrzt.public.blob.vercel-storage.com/cleanshoe.mov;

      /* Title & short credit */
      --title: "Tie";
      --credit: "Visual by Quim Amat";

      /* Video size */
      --video-width: 900px;

      /* ========================================= */
      /* DETAILED CREDITS ACTIVATION               */
      /* ========================================= */
      /* → Set to "true" to show detailed credits   */
      /* → Set to "false" to hide them completely   */
      --show-detailed-credits: true;

      /* Full detailed credits text (use \n for line breaks) */
      --detailed-credit: "Directed by: Quim Amat\nProduction: Studio XYZ\nCGI & Animation: @artist_name";

      /* Font size for detailed credits */
      --credits-font-size: 0.7rem;
    }

    /* ============================================= */
    /* 3. GENERAL STYLE                             */
    /* ============================================= */
    body {
      margin: 0;
      background: rgba(255,255,255,0.96);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      backdrop-filter: blur(4px);
      overflow: auto;
    }
    .dark body { background: rgba(0,0,0,0.96); }

    .page-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 7.5rem;
      max-width: 95vw;
      padding: 5rem 10vw;
    }

    /* ============================================= */
    /* 4. VIDEO                                     */
    /* ============================================= */
    .video-container {
      position: relative;
      width: var(--video-width);
      max-width: 90vw;
      aspect-ratio: 16 / 9;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: 0 40px 100px rgba(0,0,0,0.35);
      cursor: pointer;
    }
    video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: #000;
    }

    /* ============================================= */
    /* 5. PLAY/PAUSE & FULLSCREEN BUTTONS           */
    /* ============================================= */
    .control-btn, .fullscreen-btn {
      position: absolute;
      background: rgba(255,255,255,0.95);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(0,0,0,0.4);
      transition: all 0.25s ease;
      z-index: 10;
    }
    .control-btn {
      top: 50%; left: 50%;
      transform: translate(-50%, -50%) scale(0);
      width: 52px; height: 52px;
      opacity: 0; pointer-events: none;
    }
    .control-btn.show {
      opacity: 1; pointer-events: all;
      transform: translate(-50%, -50%) scale(1);
    }
    .control-btn:hover { transform: translate(-50%, -50%) scale(1.15); }

    .fullscreen-btn {
      bottom: 10px; right: 10px;
      width: 32px; height: 32px;
      opacity: 0; pointer-events: none;
    }
    .fullscreen-btn.show { opacity: 1; pointer-events: all; }
    .fullscreen-btn:hover { transform: scale(1.1); }

    .control-btn svg, .fullscreen-btn svg { width: 60%; height: 60%; fill: #000; }

    /* ============================================= */
    /* 6. CLOSE BUTTON                              */
    /* ============================================= */
    .close-btn {
      position: fixed;
      top: 2rem; right: 2rem;
      background: none; border: none;
      font-size: 2.5rem; cursor: pointer;
      color: #000; z-index: 20;
      transition: transform 0.2s;
    }
    .dark .close-btn { color: #fff; }
    .close-btn:hover { transform: scale(1.2); }

    /* ============================================= */
    /* 7. TITLE & CREDITS                           */
    /* ============================================= */
    .video-title {
      color: #000;
      line-height: 1.2;
      opacity: 0.95;
      text-align: center;
      max-width: 360px;
      margin: 0;
    }
    .video-title .title   { font-weight: 700; font-size: 2.2rem; letter-spacing: -0.03em; }
    .video-title .dash    { display: block; margin: 0.9rem 0; font-size: 1.3rem; opacity: 0.5; font-weight: 300; }
    .video-title .credit  { display: block; font-size: 1.2rem; font-weight: 400; opacity: 0.9; }
    .video-title .credit strong { font-weight: 700; }

    .dark .video-title,
    .dark .video-title .dash,
    .dark .video-title .credit { color: #fff; }

    /* ============================================= */
    /* 8. DETAILED CREDITS WIDGET (toggleable)      */
    /* ============================================= */
    .credits-widget {
      margin-top: 1.5rem;
      text-align: center;
    }
    .credits-toggle {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      background: none;
      border: none;
      font-size: 0.9rem;
      color: inherit;
      cursor: pointer;
      padding: 0.5rem;
      transition: color 0.2s;
    }
    .credits-toggle:hover { color: #777; }
    .dark .credits-toggle:hover { color: #ccc; }

    .credits-toggle svg {
      width: 16px; height: 16px;
      fill: currentColor;
      transition: transform 0.3s ease;
    }

    .detailed-credits {
      margin-top: 0.8rem;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease;
      font-size: var(--credits-font-size);
      line-height: 1.5;
      white-space: pre-line;
      opacity: 0.9;
      text-align: center;
    }
    .detailed-credits.show {
      max-height: 1200px;
    }

    /* Hide widget if disabled */
    :root:not([data-credits-enabled]) .credits-widget {
      display: none !important;
    }

    /* ============================================= */
    /* 9. RESPONSIVE                                */
    /* ============================================= */
    @media (max-width: 1024px) {
      .page-wrapper {
        flex-direction: column;
        gap: 3rem;
        padding: 5vw;
      }
      .video-title { order: 2; max-width: 90vw; }
      .video-container { order: 1; width: 90vw; max-width: none; }
    }

    @media (orientation: landscape) and (max-width: 1024px) {
      .page-wrapper {
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 2rem;
      }
      .video-container {
        width: 70vw;
        max-width: 700px;
      }
    }
  </style>
</head>

<body class="light">

  <div class="page-wrapper">

    <!-- TITLE + SHORT CREDIT -->
    <div class="video-title">
      <div class="title" id="title-el"></div>
      <div class="dash">-</div>
      <div class="credit" id="credit-el"></div>

      <!-- DETAILED CREDITS WIDGET -->
      <div class="credits-widget">
        <button class="credits-toggle" id="credits-toggle">
          Credits
          <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
        </button>
        <div class="detailed-credits" id="detailed-credits"></div>
      </div>
    </div>

    <!-- VIDEO PLAYER -->
    <div class="video-container" id="video-container">
      <video id="video-el" preload="metadata" playsinline></video>

      <!-- Play/Pause Button -->
      <div class="control-btn" id="control-btn">
        <svg id="play-icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
        <svg id="pause-icon" viewBox="0 0 24 24" style="display:none;"><path d="M14,19H18V5H14M6,19H10V5H6V19Z"/></svg>
      </div>

      <!-- Fullscreen Button -->
      <div class="fullscreen-btn" id="fullscreen-btn">
        <svg id="enter-fs" viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>
        <svg id="exit-fs" viewBox="0 0 24 24" style="display:none;"><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm1-8V7h-3V5h5v5h-2z"/></svg>
      </div>
    </div>
  </div>

  <!-- Close button -->
  <button class="close-btn" onclick="window.location.href = 'index.html'">×</button>

  <!-- ============================================= -->
  <!-- JAVASCRIPT (clean, beginner-friendly)        -->
  <!-- ============================================= -->
  <script>
    /* -------------------------------------------------
       STEP 1: Load title & short credit
       ------------------------------------------------- */
    const titleEl = document.getElementById('title-el');
    const creditEl = document.getElementById('credit-el');

    const titleText = getComputedStyle(document.documentElement).getPropertyValue('--title').trim();
    const creditText = getComputedStyle(document.documentElement).getPropertyValue('--credit').trim();

    titleEl.textContent = titleText;

    if (creditText.toLowerCase().includes('by')) {
      const [a, b] = creditText.split(/by/i);
      creditEl.innerHTML = (a ? a.trim() + ' by ' : 'by ') + '<strong>' + b.trim() + '</strong>';
    } else {
      creditEl.textContent = creditText;
    }

    document.title = titleText + ' - Tristan Partridge';

    /* -------------------------------------------------
       STEP 2: Load video
       ------------------------------------------------- */
    const video = document.getElementById('video-el');
    video.src = getComputedStyle(document.documentElement).getPropertyValue('--video-src').trim();

    /* -------------------------------------------------
       STEP 3: Apply saved theme
       ------------------------------------------------- */
    if (localStorage.getItem('theme') === 'dark') {
      document.body.classList.add('dark');
    }

    /* -------------------------------------------------
       STEP 4: Detailed credits – activation & content
       ------------------------------------------------- */
    const showCredits = getComputedStyle(document.documentElement)
      .getPropertyValue('--show-detailed-credits').trim() === 'true';

    if (showCredits) {
      document.documentElement.dataset.creditsEnabled = 'true';

      const fullText = getComputedStyle(document.documentElement)
        .getPropertyValue('--detailed-credit').trim().replace(/\\n/g, '\n');

      document.getElementById('detailed-credits').textContent = fullText;
    }

    /* -------------------------------------------------
       STEP 5: Elements & state
       ------------------------------------------------- */
    const playBtn = document.getElementById('control-btn');
    const playIcon = document.getElementById('play-icon');
    const pauseIcon = document.getElementById('pause-icon');
    const fsBtn = document.getElementById('fullscreen-btn');
    const enterIcon = document.getElementById('enter-fs');
    const exitIcon = document.getElementById('exit-fs');
    const container = document.getElementById('video-container');

    let hideTimer;
    let isMobile = window.matchMedia("(max-width: 1024px)").matches;
    let wasPlayingBeforeExit = false;

    /* -------------------------------------------------
       STEP 6: Fullscreen helpers
       ------------------------------------------------- */
    function isFullscreen() {
      return !!(document.fullscreenElement || document.webkitFullscreenElement ||
                document.mozFullScreenElement || document.msFullscreenElement ||
                (video.webkitDisplayingFullscreen));
    }

    function toggleFullscreen() {
      if (isFullscreen()) {
        wasPlayingBeforeExit = !video.paused;
        if (document.exitFullscreen) document.exitFullscreen();
        else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        else if (document.mozCancelFullScreen) document.mozCancelFullScreen();
        else if (document.msExitFullscreen) document.msExitFullscreen();
        else if (video.webkitExitFullscreen) video.webkitExitFullscreen();
      } else {
        if (video.requestFullscreen) video.requestFullscreen();
        else if (video.webkitRequestFullscreen) video.webkitRequestFullscreen();
        else if (video.mozRequestFullScreen) video.mozRequestFullScreen();
        else if (video.msRequestFullscreen) video.msRequestFullscreen();
        else if (video.webkitEnterFullscreen) video.webkitEnterFullscreen();
      }
    }

    function updateFullscreenIcons() {
      enterIcon.style.display = isFullscreen() ? 'none' : 'block';
      exitIcon.style.display = isFullscreen() ? 'block' : 'none';
    }

    /* -------------------------------------------------
       STEP 7: Play/Pause helpers
       ------------------------------------------------- */
    function updatePlayIcon() {
      playIcon.style.display = video.paused ? 'block' : 'none';
      pauseIcon.style.display = video.paused ? 'none' : 'block';
    }

    function togglePlayPause() {
      if (video.paused) {
        video.play();
        hideButtons(isMobile ? 800 : 1800);
      } else {
        video.pause();
        hideButtons(3000);
      }
      updatePlayIcon();
    }

    function showButtons() {
      clearTimeout(hideTimer);
      playBtn.classList.add('show');
      fsBtn.classList.add('show');
    }

    function hideButtons(delay = 1500) {
      clearTimeout(hideTimer);
      hideTimer = setTimeout(() => {
        playBtn.classList.remove('show');
        fsBtn.classList.remove('show');
      }, delay);
    }

    /* -------------------------------------------------
       STEP 8: Mouse & touch interactions
       ------------------------------------------------- */
    function handleContainerClick(e) {
      if (e.target.closest('#fullscreen-btn')) return;
      if (e.target.closest('#control-btn')) {
        togglePlayPause();
        return;
      }

      if (isMobile) {
        if (playBtn.classList.contains('show')) {
          hideButtons(0);
        } else {
          showButtons();
          if (!video.paused) hideButtons(3000);
        }
      } else {
        togglePlayPause();
      }
    }

    container.addEventListener('click', handleContainerClick);
    container.addEventListener('mouseenter', () => {
      if (!isMobile) {
        showButtons();
        hideButtons(1200);
      }
    });
    container.addEventListener('mouseleave', () => {
      if (!isMobile && !video.paused) hideButtons(300);
    });

    /* -------------------------------------------------
       STEP 9: Keyboard shortcuts (Space + F)
       ------------------------------------------------- */
    document.addEventListener('keydown', (e) => {
      const active = document.activeElement;
      const isTyping = active && (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA' || active.isContentEditable);
      if (isTyping) return;

      if (e.code === 'Space' || e.key === ' ') {
        if (!isMobile || isFullscreen()) {
          e.preventDefault();
          togglePlayPause();
        }
      }

      if (e.key.toLowerCase() === 'f' && !isFullscreen()) {
        e.preventDefault();
        toggleFullscreen();
      }
    });

    /* -------------------------------------------------
       STEP 10: Fullscreen button & events
       ------------------------------------------------- */
    fsBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleFullscreen();
    });

    playBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      togglePlayPause();
    });

/* ================================================= */
/* 10.5: FULLSCREEN EXIT → KEEP PLAYING ALWAYS */
/* ================================================= */
let wasFullscreen = false;
let ignoreNextPause = false;

['fullscreenchange', 'webkitfullscreenchange', 'mozfullscreenchange', 'MSFullscreenChange'].forEach(evt =>
  document.addEventListener(evt, () => {
    const nowFullscreen = isFullscreen();

    // Entering fullscreen
    if (nowFullscreen) {
      wasPlayingBeforeExit = !video.paused;
      ignoreNextPause = false;
    }

    // Exiting fullscreen
    if (wasFullscreen && !nowFullscreen) {
      if (wasPlayingBeforeExit) {
        // Mark the next pause event as "expected" (triggered by fullscreen exit)
        ignoreNextPause = true;

        // Resume after the browser finishes the forced pause
        setTimeout(() => {
          if (video.paused) {
            video.play().catch(() => {});
          }
          ignoreNextPause = false;
        }, 300);
      }
    }

    wasFullscreen = nowFullscreen;
    updateFullscreenIcons();
  })
);

// Intercept pause events caused by fullscreen exit
video.addEventListener('pause', () => {
  if (ignoreNextPause) {
    // Immediately resume if pause came from fullscreen exit
    setTimeout(() => {
      video.play().catch(() => {});
    }, 150);
  }
});




    // Initial state
    showButtons();
    updatePlayIcon();
    updateFullscreenIcons();

    /* -------------------------------------------------
       STEP 11: Credits toggle
       ------------------------------------------------- */
    const creditsToggle = document.getElementById('credits-toggle');
    const creditsList = document.getElementById('detailed-credits');
    const arrow = creditsToggle?.querySelector('svg');

    if (creditsToggle) {
      creditsToggle.addEventListener('click', () => {
        creditsList.classList.toggle('show');
        arrow.style.transform = creditsList.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
      });
    }

    /* -------------------------------------------------
       STEP 12: Mobile detection
       ------------------------------------------------- */
    const mediaQuery = window.matchMedia("(max-width: 1024px)");
    mediaQuery.addEventListener('change', (e) => {
      isMobile = e.matches;
    });
  </script>
</body>
</html>